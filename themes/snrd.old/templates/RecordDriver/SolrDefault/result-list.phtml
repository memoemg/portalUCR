<?

$data = $this->driver->getRawData();

//$summAuthors = $this->driver->getPrimaryAuthorsWithHighlighting();
$summAuthors = $data['dc.creator.none.fl_str_mv'];
$summDate = $this->driver->getPublicationDates();
$description = $data['dc.description.none.fl_txt_mv'];
$subject = $data['dc.subject.none.fl_str_mv'];
$publisher = $data['instname_str'];
$repo = $data['reponame_str'];
$langs = $data['language'];
$type = $data['format'];
switch($type[0]){
  case 'article':
    $icon = 'newspaper-o';
    break;
  case 'book':
    $icon = 'book';
    break;
  case 'bookPart':
    $icon = 'bookmark';
    break;
  case 'bachelorThesis' || 'doctoralThesis' || 'masterThesis' :
    $icon = 'university';
    break;
  case 'report' || 'patent':
    $icon = 'file';
    break;
  case 'conferenceObject':
    $icon = 'file';
    break;
  case 'report' || 'patent':
    $icon = 'file';
    break;
    
  default:
    $icon = 'file-o';
    break;
}
?>

<div class="doctype">
  <i class="fa fa-<?=$icon ?>"></i>&nbsp;<?= $this->transEsc($type[0]); ?>
</div>
<input type="hidden" value="<?= $this->escapeHtmlAttr($this->driver->getUniqueID()) ?>" class="hiddenId" />
<input type="hidden" value="<?= $this->escapeHtmlAttr($this->driver->getSourceIdentifier()) ?>" class="hiddenSource" />
<div class="media">
  <div class="media-body">
    <div class="result-body">
      <div class="row">
        <div class="col-sm-12 titleContainer">
          <a href="<?= $this->recordLink()->getUrl($this->driver) ?>" class="title getFull" data-view="<?= $this->params->getOptions()->getListViewOption() ?>">
            <?= $this->record($this->driver)->getTitleHtml() ?>
          </a>
        </div>
        <div class="col-xs-12 text-left authors">
          <p><b><?= $this->transEsc('Authors') ?></b>:
          <?
          $authorCount = count($summAuthors);
          foreach ($summAuthors as $i => $summAuthor):
            ?>
            <a class="author" href="<?= $this->record($this->driver)->getLink('author', $this->highlight($summAuthor, null, true, false)) ?>"><?= $this->highlight($summAuthor) ?></a><?= $i + 1 < $authorCount ? ',' : '' ?>
          <? endforeach; ?>
          </p>
        </div>
        <div class="col-xs-12 col-lg-6 text-lg-right">
          <p><b><?= $this->transEsc('Publication Date') ?>:</b> <?= $this->escapeHtml($summDate[0]) ?>.</p>
        </div>
        <div class="col-xs-12 text-sm-right">
          <p><b><?= $this->transEsc('Language') ?>:</b> <?php foreach($langs as $lang):?><?= $this->escapeHtml($this->transEsc($lang)) ?>. <? endforeach ?></p>
        </div>
      </div>
      <? if ($description): ?>
        <div class="row">
          <div class="col-sm-12 ">
            <p><a href="#" class="showAbstract" data-id="<?= $this->escapeHtmlAttr($this->driver->getUniqueId()) ?>"><?= $this->transEsc('See description') ?> (+)</a></p>
          </div>

          <div id="description-<?= $this->escapeHtmlAttr($this->driver->getUniqueId()) ?>" class="col-sm-12 description" style="display:none;">
            <div class="abstract"><p><b><?= $this->transEsc('Abstract') ?>:</b></p>
              <? foreach ($description as $a): ?>
                <? $fil = strpos($a, 'Fil:'); ?>
                <? if ($fil === false): ?>
                  <p class="text-justify"><?= $this->escapeHtml($a) ?></p>
                <? else: ?>
                  <p class="text-justify"> <b><?= $this->transEsc('Affiliation') ?></b>: <?= trim(substr($this->escapeHtml($a), 4)) ?></p>
                <? endif; ?>
              <? endforeach; ?> 
            </div>
            <? if ($subject): ?>
              <div class="col-sm-12 subject">
                <p><b><?= $this->transEsc('Subject') ?>:</b>
                  <? $subjectCount = count($subject);
                  foreach ($subject as $i => $subj):
                  ?>
                  <a class="subject" href="<?= $this->record($this->driver)->getLink('subject', $this->highlight($subj, null, true, false)) ?>"><?= $this->highlight($subj) ?></a><?= $i + 1 < $subjectCount ? '; ' : '.' ?>
                  <? endforeach; ?>
                </p>
              </div>
            <? endif; ?> 
          </div>
        </div>
      <? endif; ?>
    </div>
      <div class="row">
        <div class="col-sm-12 repo">
          <!--<p class="triangle">&nbsp;</p>-->
          <p class="reponame"><?= $repo ?>. <?= $publisher ?></p>
        </div>
      </div>
  </div>
</div>